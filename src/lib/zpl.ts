import type { Item } from "@/types/item";
import type { SalesItem } from "@/types/sales-item";

export const generateZplForItem = (item: Item): string => {
  let optionLabel = "";
  let shapeZpl = "";

  if (item.avaria) {
    optionLabel = "AVARIA";
    // Draw a triangle with graphic lines
    shapeZpl = `
    ; =============== Triângulo (correto) ===============
    ; Apex (406,200) | Base E (246,420) | Base D (566,420)

    ^FO300,200^GD100,220,8,B,R^FS   ; lado esquerdo  (diagonal BL->TR)
    ^FO400,200^GD100,220,8,B,L^FS   ; lado direito   (diagonal TL->BR)
    ^FO300,420^GB208,0,8^FS       ; base horizontal`;
  } else if (item.defeito) {
    optionLabel = "DEFEITO";
    // Draw a square (Graphic Box)
    shapeZpl = `
    ; ============== Quadrado ==============
    ; Posição (246,200) | Largura e Altura 220 | Espessura 8

    ^FO300,208^GB220,220,8^FS`;
  } else if (item.pendencia) {
    optionLabel = "PENDENCIA";
    // Draw a circle (Graphic Circle)
    shapeZpl = `
    ; ============== Círculo ============== 
    ; Centro (406,310) | Diâmetro 220 | Espessura 8

    ^FO300,208^GC220,8,B^FS`;
  }

  let freeTextZpl = "";
  if (item.freeText) {
    freeTextZpl = `
; =============== Texto Livre ========== 
^FO80,850
^CF0,40
^TB,652,300,J
^FD${item.freeText}^FS`;
  }

  // A simple ZPL template
  const zpl = `
^XA
^PW812              ; largura 4" em 203 dpi
^LL1218             ; altura 6" em 203 dpi
^CI28               ; UTF-8
^LH0,0

; =============== Moldura =================
^FO40,40^GB732,1138,8^FS   ; caixa (x,y,width,height,espessura)

${shapeZpl}

; =============== Tipo de Problema ========== 
^FO0,450
^CF0,48
^FB812,1,0,C
^FD${optionLabel}^FS

; =============== Número (ACELERATO) ========== 
^FO0,540
^CF0,120
^FB812,1,0,C
^FD#${item.acelerato}^FS

; =============== Grau de Reparo ========== 
^FO0,690
^CF0,48
^FB812,1,0,C
^FDGRAU DE REPARO:^FS

^FO0,750
^CF0,60
^FB812,1,0,C
^FD${item.grau}^FS

${freeTextZpl}

^XZ`;

  return zpl;
};

export const generateSalesZpl = (item: SalesItem): string => {
  return `
^XA

^FX --- CONFIGURACAO DA ETIQUETA (6cm x 8cm) ---
^PW480
^LL640
^CI28

^FX --- 1. LOGO INTEGRADA ---
^FO15,15^GFA,3382,3382,38,,:::gM03F,gL03FFC,gK01IFC,gJ01JFE,gI01KFE,gI0LFE,gH0MFE,gG0NFE,g07NFC,Y07OFC,X07PF,W07PF8,V07PFC,U03PFC,T03PFC,07F8O03PFE,0IFCM01PFE,1KF8J01PFE,3LFE001PFE,3NF0QF,3YF,3XF,3WF8,1VF8,0UF8,07SF8,007QFC,I01OFC,K07LFC,L01JFE,N0IF,N07FF,::::::::N07FF001KFC1FFI03FE0KF003KFC1JFCJ03FF8003JF8007KF,N07FF001KFE1FFI03FE0KFC03KFC1KFJ07FF8003JFE007KF,N07FF001KFE1FF8007FE0KFE03KFC1KFCI07FF8003KF807KF,N07FF001KFE1FFC00FFE0LF03KFC1KFEI0IFC003KFC07KF,N07FF001KFE1FFC00FFE0LF83KFC1LFI0IFC003KFE07KF,N07FF001KFE1FFE01FFE0LFC3KFC1LFI0IFC003KFE07KF,N07FF001KFC1FFE01FFE0LFC3KFC1LF801IFE003LF07KF,N07FF001FFJ01IF03FFE0FFC0FFC3FEJ01FF03FF801IFE003FE07FF07FC,N07FF001FFJ01IF03FFE0FFC07FC3FEJ01FF01FF803JF003FE03FF07FC,N07FF001FFJ01IF87FFE0FFC07FE3FEJ01FF01FF803JF003FE03FF07FC,N07FF001FFJ01IFCIFE0FFC07FE3FEJ01FF01FF803FCFF003FE03FF07FC,N07FF001KF81IFCIFE0FFC07FE3KF01FF01FF807FCFF803FE03FF07JFC,N07FF001KF81IFCIFE0FFC07FE3KF01FF01FF807FCFF803FE03FF07JFC,N07FF001KFC1MFE0FFC0FFC3KF81FF03FF807FCFF803FE07FF07JFE,N07FF001KFC1MFE0LFC3KF81LF807F87F803KFE07JFE,N07FF001KFC1MFE0LFC3KF81LF00FF87FC03KFE07JFE,N07FF001KFC1MFE0LF83KF81KFE00FF87FC03KFC07JFE,N07FF001KFC1FF7FFBFE0LF03KF81KFE00FF03FC03KFC07JFE,N07FF001KFC1FF3FF3FE0KFE03KF81KFC01FF03FE03KF007JFE,N07FF001FFJ01FF3FF3FE0KFC03FFJ01KF001KFE03JFE007FC,N07FF001FFJ01FF1FE3FE0JFE003FEJ01KF801LF03KF007FC,N07FF001FFJ01FF1FE3FE0FFCJ03FEJ01FF0FF803LF03FE3FF007FC,N07FF001FFJ01FF0FC3FE0FFCJ03FEJ01FF0FFC03LF03FE1FF807FC,N07FF001FFJ01FF0783FE0FFCJ03FFJ01FF0FFC07LF83FE0FF807FC,N07FF001KFE1FFI03FE0FFCJ03KFC1FF07FE07LF83FE0FFC07KF,N07FF001KFE1FFI03FE0FFCJ03KFC1FF03FE07LF83FE0FFC07KF,N07FF001KFE1FFI03FE0FFCJ03KFC1FF03FF0FFDJFC3FE07FE07KF,N07FF001KFE1FFI03FE0FFCJ03KFC1FF03FF0FF8007FC3FE07FE07KF,N07FF001KFE1FFI03FE0FFCJ03KFC1FF01FF8FF8007FC3FE03FF07KF,N07FF001KFE1FFI03FE0FFCJ03KFC1FF01FFDFF8007FE3FE03FF87KF,N07FF001KFE0FFI03FC0FFCJ03KFC1FF00FFDFFI03FE3FE01FF87KF,N07FF,:::::::N03FE,N01FC,O07,,:::^FS

^FX --- 2. LINHA SEPARADORA SUPERIOR ---
^FO10,110
^GB460,2,2^FS

^FX --- 3. NOME DO PRODUTO ---
^FO20,130
^A0N,30,30
^FB440,3,0,L,0
^FD${item.productName}^FS

^FX --- REF ---
^FO20,220
^A0N,20,20
^FB440,1,0,L,0
^FD- REF: ${item.sku}^FS

^FX --- 4. PRECO 'DE' ---
^FO20,260
^A0N,25,25
^FB440,1,0,L,0
^FDDe R$ ${item.priceFrom}

^FS

^FX --- 5. PRECO 'POR' ---
^FO20,290
^A0N,45,45
^FB440,1,0,L,0
^FDPor R$ ${item.priceTo}^FS 
^FO350,300
^A0N,30,30
^FB440,1,0,L,0
^FD(A vista)^FS

^FX --- 6. PARCELAMENTO ---
^FO20,340
^A0N,20,20
^FB440,2,0,L,0
^FDOu em ate 12x de^FS
^FO20,365
^A0N,20,20
^FB440,1,0,L,0
^FDR$ ${item.installments} sem juros^FS

^FX --- 7. LINHA SEPARADORA INFERIOR ---
^FO10,410
^GB460,2,2^FS

^FX --- 8. CODIGO DE BARRAS ---
^FO60,440
^BY2,3,100
^BCN,100,Y,N,N
^FD${item.barcode}^FS

^XZ`;
};