import type { Item } from "@/types/item";
import type { SalesItem } from "@/types/sales-item";
import { formatCurrency } from "./utils";

export const generateZplForItem = (item: Item): string => {
  let optionLabel = "";
  let shapeZpl = "";

  if (item.avaria) {
    optionLabel = "AVARIA";
    shapeZpl = `^FO300,200^GD100,220,8,B,R^FS
^FO400,200^GD100,220,8,B,L^FS
^FO300,420^GB208,0,8^FS`;
  } else if (item.defeito) {
    optionLabel = "DEFEITO";
    shapeZpl = `^FO300,208^GB220,220,8^FS`;
  } else if (item.pendencia) {
    optionLabel = "PENDENCIA";
    shapeZpl = `^FO300,208^GC220,8,B^FS`;
  }

  let freeTextZpl = "";
  if (item.freeText) {
    freeTextZpl = `^FO80,850^A0N,40,40^FB652,3,0,J,0^FD${item.freeText}^FS`;
  }

  return `^XA
^PW812
^LL1218
^CI28
^LH0,0
^FO40,40^GB732,1138,8^FS
${shapeZpl}
^FO0,450^A0N,48,48^FB812,1,0,C,0^FD${optionLabel}^FS
^FO0,540^A0N,120,120^FB812,1,0,C,0^FD#${item.acelerato}^FS
^FO0,690^A0N,48,48^FB812,1,0,C,0^FDGRAU DE REPARO:^FS
^FO0,750^A0N,60,60^FB812,1,0,C,0^FD${item.grau}^FS
${freeTextZpl}
^XZ`;
};

export const generateSalesZpl = (item: SalesItem): string => {

  const priceFromFormatted = formatCurrency(item.priceFrom);
  const priceToFormatted = formatCurrency(item.priceTo);
  const installmentsFormatted = formatCurrency(item.installments);
  const qrcodeZpl = item.qrcode
    ? `^FO310,10^BQN,2,3^FDQA,${item.qrcode.trim()}^FS`
    : "";

  return `^XA
^PW480
^LL640
^CI28
^FO10,50^GFA,2368,2368,32,,::gI09,gH07F8,gG07FFC,g07IFE,Y07JFE,X03KFE,W03LFE,V03MFC,U01NF8,T01OF,S01OF,S0OF,R0OF8,0FFN0OF8,1IFCK0OF8,3KFI07NF8,3LFC7NFC,3UFC,3TFC,3SFC,1RFE,0QFE,00OFE,I03MF,K0KF,L03FF8,L01FF8,::::::L01FF803JF03EI07C0IF8007JF07FFCJ07F8007FFC001JF8,L01FF803JF87FI0FE0JF807JF0JFCI0FFC007IFC03JFC,L01FF807JF87F801FE0JFE07JF0JFEI0FFC007JF03JFC,L01FF807JF87FC01FE0KF07JF0KFI0FFE007JF83JFC,L01FF807JF87FC03FE0KF87JF0KF801FFE007JFC3JFC,L01FF807JF87FE07FE0KF87JF0KFC01FFE007JFC3JFC,L01FF807JF07FE07FE0FF0FF87IFE0FF07FC03IF007F87FC3JF8,L01FF807F8I07FF0FFE0FF07FC7FJ0FF03FC03IF007F03FC3FC,L01FF807F8I07FF8FFE0FF03FC7FJ0FF03FC03IF007F03FE3FC,L01FF807F8I07FF9FFE0FF03FC7FJ0FF03FC07F3F807F03FE3FC,L01FF807JF07FFDFFE0FF07FC7IFE0FF07FC07F3F807F03FC3JF8,L01FF807JF07KFE0KF87JF0KFC07F3FC07JFC3JF8,L01FF807JF07KFE0KF87JF0KF80FE1FC07JFC3JF8,L01FF807JF07KFE0KF07JF0KF80FE1FC07JF83JF8,L01FF807JF07F7FEFE0KF07JF0KF00FE1FE07JF03JF8,L01FF807JF07F3FCFE0JFE07IFE0JFE01FE1FE07IFE03JF8,L01FF807F8I07F1FCFE0JF007FJ0JFC01JFE07IFE03FC,L01FF807F8I07F9F8FE0FFJ07FJ0FF1FE03KF07F9FE03FC,L01FF807F8I07F8F8FE0FFJ07FJ0FF1FE03KF07F0FF03FC,L01FF807FCI07F870FE0FFJ07F8I0FF0FF03KF07F0FF03FE,L01FF807JF87F800FE0FFJ07JF8FF0FF87KF87F07F83JF8,L01FF807JFC7F800FE0FFJ07JF8FF07F87KF87F07F83JF8,L01FF807JFC7F800FE0FFJ07JF8FF07FC7F803FC7F03FC3JF8,L01FF807JFC7F800FE0FFJ07JF8FF03FCFF003FC7F03FE3JF8,L01FF803JF87FI0FE0FFJ07JF8FF03FEFF001FC7F01FE3JF8,L01FF803JF83FI07C0FEJ07JF07F01FC7E001FC7F00FE1JFC,L01FF8,::::M0FF8,M0FF,M07E,,:::^FS
${qrcodeZpl}
^FO20,195^A0N,30,30^FB440,3,0,L,0^FD${item.productName}^FS
^FO20,290^A0N,20,20^FB440,1,0,L,0^FD- REF: ${item.sku}^FS
^FO20,330^A0N,25,25^FB440,1,0,L,0^FDDe R$ ${priceFromFormatted}^FS
^FO20,370^A0N,45,45^FB440,1,0,L,0^FDPor R$ ${priceToFormatted}^FS
^FO360,380^A0N,30,30^FB440,1,0,L,0^FD(A vista)^FS
^FO20,420^A0N,20,20^FB440,2,0,L,0^FDOu em ate ${item.installmentCount}x de^FS
^FO20,450^A0N,20,20^FB440,1,0,L,0^FDR$ ${installmentsFormatted} sem juros^FS
^FO10,490^GB460,2,2^FS
^FO60,510^BY2,3,100^BCN,100,Y,N,N^FD${item.barcode}^FS
^XZ`;
};